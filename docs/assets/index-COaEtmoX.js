import{r as h,g as p}from"./phaser-Czz4FBZH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var f=h();const n=p(f),l=[{id:"A1",text:`俺のフロウは最強、ビートを支配する
お前のライムは弱小、勝負にならない`,type:"attack",rhymeScore:20,countersTo:["technical"]},{id:"A2",text:`ここは俺のステージ、お前は帰れ
実力の差を見せてやる、これが真のMC`,type:"attack",rhymeScore:25,countersTo:["technical"]},{id:"A3",text:`お前のスキルじゃ俺には勝てない
このバトルで証明する、俺がナンバーワン`,type:"attack",rhymeScore:20,countersTo:["technical"]},{id:"B1",text:`韻を踏むのは俺の専門、リズムも完璧
君のスタイルじゃこのバトル、勝利は不可能`,type:"technical",rhymeScore:30,countersTo:["counter"]},{id:"B2",text:`ワードプレイで魅せる俺のアート
メタファーとライムで編む最高のパート`,type:"technical",rhymeScore:30,countersTo:["counter"]},{id:"B3",text:`フロウとビートが俺の武器
音楽と言葉で作る完璧な仕組み`,type:"technical",rhymeScore:25,countersTo:["counter"]},{id:"C1",text:`そんな挑発じゃ俺は動じない
冷静にライムで返すのが俺のスタイル`,type:"counter",rhymeScore:15,countersTo:["attack"]},{id:"C2",text:`お前の攻撃は見透かした
今度は俺のターン、逆転開始だ`,type:"counter",rhymeScore:15,countersTo:["attack"]},{id:"C3",text:`弱い犬ほどよく吠える、俺は結果で語る
最後に笑うのは誰か、もうすぐ分かる`,type:"counter",rhymeScore:20,countersTo:["attack"]},{id:"D1",text:`これで決着、俺の勝利は確定
お前もよく頑張った、でも俺が上だ`,type:"closing",rhymeScore:10,countersTo:[]},{id:"D2",text:`4ターンかけて証明した、俺のスキルの高さ
次回があるならまた来い、今日は俺の勝ち`,type:"closing",rhymeScore:10,countersTo:[]},{id:"D3",text:`最後のライムで締めくくる、この勝負は俺のもの
観客も納得の結果だろう、お疲れ様でした`,type:"closing",rhymeScore:10,countersTo:[]}],u=90,a=6e4/u,d=50,y=100;class S extends n.Scene{gameState;beatTimer;nextBeatTime=0;playerLyrics=[];opponentLyrics=[];playerScoreText;opponentScoreText;turnText;feedbackText;opponentActionText;beatMarker;lyricsButtons=[];constructor(){super({key:"BattleScene"})}init(t){this.playerLyrics=t.selectedLyrics||l.slice(0,4),this.opponentLyrics=l.filter(e=>e.type==="attack"||e.type==="technical")}create(){this.gameState={currentTurn:1,playerScore:0,opponentScore:0,beatCount:0,gamePhase:"waiting",opponentLyric:null},this.add.text(400,30,"BATTLE START",{font:"32px Arial",color:"#ff0000"}).setOrigin(.5),this.playerScoreText=this.add.text(30,30,"YOU: 0",{font:"24px Arial",color:"#00ff00"}),this.opponentScoreText=this.add.text(770,30,"CPU: 0",{font:"24px Arial",color:"#ff0000"}).setOrigin(1,0),this.turnText=this.add.text(400,70,"Turn: 1/4",{font:"24px Arial",color:"#ffffff"}).setOrigin(.5),this.feedbackText=this.add.text(400,300,"",{font:"32px Arial",color:"#ffff00",align:"center"}).setOrigin(.5),this.opponentActionText=this.add.text(400,200,"",{font:"24px Arial",color:"#ff8888",align:"center"}).setOrigin(.5),this.beatMarker=this.add.text(400,120,"●",{font:"32px Arial",color:"#ffffff"}).setOrigin(.5).setVisible(!1),this.createLyricsButtons(),this.setupBeatTimer()}setupBeatTimer(){this.nextBeatTime=this.time.now,this.beatTimer=this.time.addEvent({delay:a,callback:this.onBeat,callbackScope:this,loop:!0})}onBeat(){this.gameState.beatCount++,this.nextBeatTime+=a,this.beatMarker.setVisible(!0),this.tweens.add({targets:this.beatMarker,alpha:0,duration:a/2,onComplete:()=>this.beatMarker.setAlpha(1).setVisible(!1)}),this.gameState.beatCount%8===1?this.opponentTurn():this.gameState.beatCount%8===5&&this.playerTurn()}opponentTurn(){this.gameState.gamePhase="waiting",this.toggleLyricsButtons(!1);const t=this.opponentLyrics[n.Math.Between(0,this.opponentLyrics.length-1)];this.gameState.opponentLyric=t;const o=(Math.random()>.2?50:30)+t.rhymeScore;this.gameState.opponentScore+=o,this.updateScoreDisplay(),this.opponentActionText.setText(`[CPU] ${t.text.replace(`
`," / ")}`),this.feedbackText.setText("")}playerTurn(){this.feedbackText.setText("YOUR TURN: SELECT!"),this.gameState.gamePhase="selecting",this.toggleLyricsButtons(!0)}createLyricsButtons(){this.playerLyrics.forEach((t,e)=>{const o=450+Math.floor(e/2)*60,r=250+e%2*300,s=this.add.text(r,o,t.text.replace(`
`," / "),{font:"16px Arial",color:"#ffffff",backgroundColor:"#333333",padding:{x:10,y:5}}).setOrigin(.5).setInteractive();s.on("pointerdown",()=>this.handlePlayerInput(t)),this.lyricsButtons.push(s)}),this.toggleLyricsButtons(!1)}handlePlayerInput(t){if(this.gameState.gamePhase!=="selecting")return;this.gameState.gamePhase="performing",this.toggleLyricsButtons(!1);const e=Math.abs(this.time.now-this.nextBeatTime);let o;e<=d?o={accuracy:"perfect",score:50}:e<=y?o={accuracy:"good",score:30}:o={accuracy:"miss",score:0};let r=0;this.gameState.opponentLyric&&t.countersTo.includes(this.gameState.opponentLyric.type)&&(r=50);const s=t.rhymeScore,i=o.score+r+s;this.gameState.playerScore+=i,this.updateScoreDisplay(),this.showFeedback(o,r,s),this.advanceTurn()}updateScoreDisplay(){this.playerScoreText.setText(`YOU: ${this.gameState.playerScore}`),this.opponentScoreText.setText(`CPU: ${this.gameState.opponentScore}`)}showFeedback(t,e,o){const r=`Rhythm: ${t.accuracy.toUpperCase()} +${t.score}
Choice: +${e}
Rhyme: +${o}`;this.feedbackText.setText(r),this.opponentActionText.setText("")}advanceTurn(){this.gameState.currentTurn<4?(this.gameState.currentTurn++,this.time.delayedCall(1500,()=>{this.turnText.setText(`Turn: ${this.gameState.currentTurn}/4`),this.feedbackText.setText("")})):this.time.delayedCall(2e3,()=>this.endBattle())}endBattle(){this.beatTimer.destroy(),this.gameState.gamePhase="result",this.feedbackText.setText(`FINISH!
Final Score: ${this.gameState.playerScore}`),this.time.delayedCall(3e3,()=>{this.scene.start("ResultScene",{playerScore:this.gameState.playerScore,opponentScore:this.gameState.opponentScore})})}toggleLyricsButtons(t){this.lyricsButtons.forEach(e=>{e.setInteractive(t).setAlpha(t?1:.5)})}}class g extends n.Scene{constructor(){super({key:"MainMenuScene"})}create(){this.add.text(400,250,"ラップバトルゲーム",{font:"48px Arial",color:"#ffffff"}).setOrigin(.5),this.add.text(400,350,"クリックして開始",{font:"32px Arial",color:"#ffffff"}).setOrigin(.5),this.input.on("pointerdown",()=>{this.scene.start("LyricsSelectScene")})}}class x extends n.Scene{selectedLyrics=[];startButton;constructor(){super({key:"LyricsSelectScene"})}create(){this.add.text(400,50,"歌詞を4つ選択してください",{font:"32px Arial",color:"#ffffff"}).setOrigin(.5),this.renderLyrics(),this.startButton=this.add.text(400,550,"バトル開始",{font:"32px Arial",color:"#888888",backgroundColor:"#555555",padding:{x:10,y:5}}).setOrigin(.5),this.updateStartButtonState()}renderLyrics(){let t=100;l.forEach(e=>{const o=this.add.text(100,t,`[${e.type}] ${e.text.replace(`
`," / ")}`,{font:"16px Arial",color:"#ffffff",backgroundColor:"#333333",padding:{x:5,y:5},wordWrap:{width:600}}).setInteractive({useHandCursor:!0});o.on("pointerdown",()=>{this.toggleLyricSelection(e,o)}),t+=o.height+10})}toggleLyricSelection(t,e){const o=this.selectedLyrics.findIndex(r=>r.id===t.id);o>-1?(this.selectedLyrics.splice(o,1),e.setBackgroundColor("#333333")):this.selectedLyrics.length<4&&(this.selectedLyrics.push(t),e.setBackgroundColor("#00ff00")),this.updateStartButtonState()}updateStartButtonState(){this.selectedLyrics.length===4?(this.startButton.setInteractive({useHandCursor:!0}),this.startButton.setColor("#ffffff"),this.startButton.setBackgroundColor("#008800"),this.startButton.off("pointerdown"),this.startButton.on("pointerdown",()=>{this.scene.start("BattleScene",{selectedLyrics:this.selectedLyrics})})):(this.startButton.disableInteractive(),this.startButton.setColor("#888888"),this.startButton.setBackgroundColor("#555555"))}}class m extends n.Scene{playerScore=0;opponentScore=0;constructor(){super({key:"ResultScene"})}init(t){this.playerScore=t.playerScore||0,this.opponentScore=t.opponentScore||0}create(){let t,e;this.playerScore>this.opponentScore?(t="YOU WIN!",e="#00ff00"):this.playerScore<this.opponentScore?(t="YOU LOSE...",e="#ff0000"):(t="DRAW",e="#ffff00"),this.add.text(400,200,t,{font:"64px Arial",color:e}).setOrigin(.5),this.add.text(400,300,`Your Score: ${this.playerScore}`,{font:"32px Arial",color:"#ffffff"}).setOrigin(.5),this.add.text(400,350,`Opponent's Score: ${this.opponentScore}`,{font:"32px Arial",color:"#ffffff"}).setOrigin(.5),this.add.text(400,450,"Play Again",{font:"32px Arial",color:"#ffffff",backgroundColor:"#333333",padding:{x:10,y:5}}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.start("MainMenuScene")})}}const T={type:n.AUTO,width:800,height:600,parent:"app",scene:[g,x,S,m]};new n.Game(T);
