# 画面レイアウト改善 設計書

## 1. 概要

本ドキュメントは、現在のWebアプリケーションの画面レイアウトに関する問題を分析し、その改善策を提案するものです。ユーザーから指摘された「ウィンドウサイズが小さい」「文字が重なる」「ボタンが見切れる」といった問題を解決し、レスポンシブデザインのベストプラクティスに沿ったUI/UXを提供することを目指します。

## 2. 現状の問題点

コードベースを調査した結果、以下の3つの主要な問題点が特定されました。

### 2.1. 固定サイズのキャンバス

`src/main.ts`にて、ゲームのキャンバスサイズが `width: 800`, `height: 600` にハードコードされています。

```typescript
// src/main.ts
const config: Phaser.Types.Core.GameConfig = {
  type: Phaser.AUTO,
  width: 800,
  height: 600,
  // ...
};
```

これにより、異なる画面サイズのデバイスで表示した際に、レイアウトが崩れたり、画面の一部しか表示されなかったりする問題が発生します。

### 2.2. ハードコードされたUI要素の配置

`src/scenes/LyricsSelectScene.ts` をはじめとする各シーンファイルで、テキストやボタンなどのUI要素が絶対座標（ピクセル指定）で配置されています。

```typescript
// src/scenes/LyricsSelectScene.ts
this.add.text(400, 50, '歌詞を4つ選択してください', { ... }); // 中央上部
// ...
this.add.text(100, yPos, `...`, { ... }); // リスト要素
// ...
this.startButton = this.add.text(400, 550, 'バトル開始', { ... }); // 下部
```

この実装では、画面サイズが変更された場合にUI要素が追従できず、意図しない位置に表示されたり、画面外にはみ出したりする原因となります。

### 2.3. コンテンツのオーバーフロー

`LyricsSelectScene` では、12個の歌詞パターンが縦にリスト表示されます。しかし、現在の実装では、リスト全体の高さが固定のキャンバスの高さ（600px）を超えてしまいます。

計算上、リストの表示に必要な高さは約 `724px` ですが、キャンバスの高さが足りないため、リストの下部にある歌詞や、そのさらに下に配置されている「バトル開始」ボタンが画面外に見切れてしまいます。これが「文字が重なる」「ボタンが見切れる」問題の直接的な原因です。

## 3. 改善案

上記の問題を解決するため、以下の設計変更を提案します。

### 3.1. レスポンシブなキャンバス設定

Phaserのスケールマネージャー機能を活用し、ゲームキャンバスがブラウザのウィンドウサイズに追従するように変更します。

- **`src/main.ts` の変更:**
  - `scale`設定を追加し、`mode`を `Phaser.Scale.RESIZE` に設定します。
  - `width` と `height` を `'100%'` に設定し、親要素（`#app` div）のサイズに追従させます。

- **`index.html` と `src/style.css` の変更:**
  - `html`, `body`, `#app` の各要素が、ビューポート全体の高さと幅を占めるようにCSSを調整します。

### 3.2. スクロール可能なリストの実装

コンテンツのオーバーフロー問題を解決するため、`LyricsSelectScene` の歌詞リストをスクロール可能なUIコンポーネントに変更します。

- 歌詞リストをPhaserの`Container`オブジェクトに格納します。
- `Graphics`オブジェクトをマスクとして使用し、リストの表示領域を定義します。
- マウスのホイールイベント（`wheel`）をリッスンし、コンテナのY座標を動かすことでスクロールを実現します。

これにより、画面領域内に収まらない数の歌詞があっても、ユーザーはスクロール操作ですべての選択肢を確認できるようになります。

### 3.3. 相対的なUI要素の配置

UI要素の配置を絶対座標から相対座標に変更し、画面サイズが変わってもレイアウトが維持されるようにします。

- **タイトル:** 画面の上部中央に配置します。
  - `x: this.scale.width * 0.5`
  - `y: 50` （上からのマージン）
- **「バトル開始」ボタン:** 画面の下部中央に配置します。
  - `x: this.scale.width * 0.5`
  - `y: this.scale.height - 50` （下からのマージン）
- **スクロールエリア:** タイトルとボタンの間の可変領域に配置します。

これらの変更により、アプリケーションは多様なデバイスやウィンドウサイズに対応できるようになり、ユーザー体験が大幅に向上します。
